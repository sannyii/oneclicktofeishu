# 悬浮按钮使用说明

## 概述

悬浮按钮是"一键发送到飞书"Chrome扩展的核心功能之一，它提供了一个便捷的方式来快速处理当前页面内容并发送到飞书群。

## 功能特点

### 🎯 便捷操作
- **一键触发**：无需打开插件弹窗，直接点击悬浮按钮即可
- **自由拖动**：按住鼠标左键可拖动按钮到任意位置
- **位置记忆**：拖动后的位置会自动保存，刷新页面后保持不变
- **视觉反馈**：鼠标悬停时显示提示信息，点击时有状态变化

### 🔄 状态管理
- **默认状态**：显示📝图标和"发送到飞书"提示
- **加载状态**：点击后变为⏳图标和"处理中..."提示，按钮被禁用
- **完成状态**：处理完成后恢复默认状态

### 🔔 通知系统
- **成功通知**：绿色通知显示"发送成功！"
- **错误通知**：红色通知显示具体错误信息
- **配置提示**：当配置缺失时显示相应的配置提示

## 使用方法

### 1. 首次使用
1. 确保已正确安装并启用扩展
2. 打开任意网页，应该能在右侧看到蓝色圆形悬浮按钮
3. 首次点击时会提示配置API密钥

### 2. 配置设置
1. 点击Chrome工具栏中的扩展图标
2. 输入OpenAI API Key
3. 输入飞书机器人Webhook URL
4. 选择AI模型（推荐GPT-5 Nano）
5. 可选：输入自定义系统提示词
6. 配置会自动保存

### 3. 正常使用
1. 打开想要处理的网页
2. 点击右侧悬浮按钮
3. 观察按钮状态变化和通知信息
4. 检查飞书群是否收到消息

### 4. 拖动功能
1. 按住鼠标左键开始拖动按钮
2. 将按钮拖动到合适的位置
3. 释放鼠标，按钮会停在当前位置
4. 位置会自动保存，下次打开页面时会保持在同一位置

## 按钮样式

### 默认样式
```css
- 位置：可拖动到任意位置（默认右侧中间）
- 大小：60x60像素
- 形状：圆形
- 颜色：蓝色渐变背景
- 图标：📝
- 阴影：蓝色阴影效果
- 拖动提示：悬停时显示"⋮⋮"拖动标识
```

### 悬停效果
```css
- 缩放：1.1倍
- 阴影：增强阴影效果
- 提示：显示"发送到飞书"文字提示
```

### 禁用状态
```css
- 背景：灰色
- 图标：⏳
- 缩放：0.9倍
- 提示：显示"处理中..."
- 拖动：禁用状态下无法拖动
```

### 拖动状态
```css
- 光标：抓取状态（grabbing）
- 过渡：无过渡动画
- 事件：禁用点击事件
```

## 通知样式

### 成功通知
- 背景：绿色 (#52c41a)
- 位置：页面右上角
- 动画：从右侧滑入
- 持续时间：3秒

### 错误通知
- 背景：红色 (#ff4d4f)
- 位置：页面右上角
- 动画：从右侧滑入
- 持续时间：3秒

### 信息通知
- 背景：蓝色 (#1890ff)
- 位置：页面右上角
- 动画：从右侧滑入
- 持续时间：3秒

## 技术实现

### 创建时机
- 页面加载完成后自动创建
- 检查是否已存在，避免重复创建
- 支持动态页面加载

### 事件处理
- 点击事件：触发内容处理和发送
- 悬停事件：显示提示信息
- 拖动事件：支持鼠标和触摸拖动
- 状态管理：处理加载和完成状态

### 通信机制
- 与background script通信获取配置
- 发送处理请求到background script
- 接收处理结果并显示通知
- 保存按钮位置到chrome.storage

## 兼容性

### 支持的网站
- 大部分网站都支持悬浮按钮显示
- 某些网站可能因为安全策略限制按钮功能
- 动态加载的页面会自动创建按钮

### 浏览器要求
- Chrome 88+
- 需要启用JavaScript
- 需要允许扩展访问页面

## 故障排除

### 按钮不显示
1. 检查扩展是否正确安装
2. 刷新页面重试
3. 检查浏览器控制台错误
4. 确认页面JavaScript是否正常

### 按钮无响应
1. 检查API配置是否完整
2. 查看通知信息了解具体错误
3. 检查网络连接
4. 确认飞书Webhook是否有效

### 拖动功能异常
1. 确保按钮没有被禁用
2. 检查是否有其他扩展干扰鼠标事件
3. 尝试刷新页面后重新拖动
4. 确认浏览器支持触摸事件（移动设备）

### 样式异常
1. 某些网站可能覆盖按钮样式
2. 检查页面CSS冲突
3. 尝试刷新页面

## 最佳实践

### 使用建议
1. 优先使用悬浮按钮，操作更便捷
2. 在配置完成后测试功能
3. 注意观察通知信息了解处理状态
4. 定期检查API配置是否有效

### 性能优化
1. 避免频繁点击按钮
2. 等待处理完成后再进行下一次操作
3. 合理设置内容长度限制

## 更新日志

### v1.0.0
- 初始版本，支持基本的悬浮按钮功能
- 集成内容提取和发送功能
- 添加状态管理和通知系统
